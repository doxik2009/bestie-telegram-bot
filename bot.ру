import os
import random
from telegram import Update, InlineKeyboardButton, InlineKeyboardMarkup
from telegram.ext import (
    Application, CommandHandler, CallbackQueryHandler,
    MessageHandler, filters, ContextTypes
)

# =======================
# –í–û–ü–†–û–°–´
# =======================

QUESTIONS_BESTIA = [
{"q": "–¢—ã –ø–∏—à–µ—à—å ¬´–æ–∫¬ª ‚Äî —ç—Ç–æ‚Ä¶"},
{"q": "–ï—Å–ª–∏ —è –æ–ø–∞–∑–¥—ã–≤–∞—é –Ω–∞ 20 –º–∏–Ω—É—Ç, —Ç—ã‚Ä¶"},
{"q": "–í –ø–ª–æ—Ö–æ–º –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∏–∏ –º–Ω–µ –ª—É—á—à–µ –ø—Ä–∏—Å–ª–∞—Ç—å‚Ä¶"},
{"q": "–ú—ã –º–æ–∂–µ–º –Ω–µ –æ–±—â–∞—Ç—å—Å—è –º–µ—Å—è—Ü –∏ –Ω–µ –æ–±–∏–∂–∞—Ç—å—Å—è?"},
{"q": "–ï—Å–ª–∏ –º—ã –ø–æ—Å—Å–æ—Ä–∏–ª–∏—Å—å ‚Äî –∫—Ç–æ –ø–µ—Ä–≤—ã–π –ø—Ä–∏—à–ª—ë—Ç –º–µ–º?"},
{"q": "–ö–∞–∫—É—é —Å–∞–º—É—é —Å—Ç—Ä–∞–Ω–Ω—É—é –ø—Ä–∏–≤—ã—á–∫—É —É –º–µ–Ω—è –∑–Ω–∞–µ—à—å?"},
{"q": "–ï—Å–ª–∏ –º—ã –∏–¥—ë–º –Ω–∞ –≤–µ—á–µ—Ä–∏–Ω–∫—É –≤–º–µ—Å—Ç–µ, –∫—Ç–æ –ø–æ—Ç–µ—Ä—è–µ—Ç—Å—è –ø–µ—Ä–≤—ã–º?"},
{"q": "–ö—Ç–æ –∏–∑ –Ω–∞—Å –±–æ–ª—å—à–µ –ª—é–±–∏—Ç –∫–æ—Ñ–µ?"},
{"q": "–ï—Å–ª–∏ –≤–¥—Ä—É–≥ –Ω–∞—á–Ω—ë—Ç—Å—è —Ç–∞–Ω—Ü–µ–≤–∞–ª—å–Ω—ã–π –±–∞—Ç—Ç–ª, –∫—Ç–æ –≤—ã–∏–≥—Ä–∞–µ—Ç?"},
{"q": "–ö—Ç–æ —á–∞—â–µ –∑–∞–±—ã–≤–∞–µ—Ç –∫–ª—é—á–∏?"},
{"q": "–° –∫–µ–º –ª–µ–≥—á–µ –ø–æ–¥–µ–ª–∏—Ç—å—Å—è —Å–µ–∫—Ä–µ—Ç–æ–º?"},
{"q": "–ö—Ç–æ –≥—Ä–æ–º—á–µ —Å–º–µ—ë—Ç—Å—è?"},
{"q": "–ï—Å–ª–∏ –±—ã –º—ã —Å—Ç–∞–ª–∏ —Å—É–ø–µ—Ä–≥–µ—Ä–æ—è–º–∏, –∫—Ç–æ –±—ã –±—ã–ª‚Ä¶"},
{"q": "–ö—Ç–æ —á–∞—â–µ –Ω–∞—á–∏–Ω–∞–µ—Ç —Å–ø–æ—Ä—ã?"},
{"q": "–ö—Ç–æ –±—ã—Å—Ç—Ä–µ–µ –µ—Å—Ç —Å–ª–∞–¥–∫–æ–µ?"},
{"q": "–ö—Ç–æ –ª—É—á—à–µ –≥–æ—Ç–æ–≤–∏—Ç –º–µ–º—ã?"},
{"q": "–ï—Å–ª–∏ —è –ø–ª–∞—á—É –Ω–∞–¥ —Å–µ—Ä–∏–∞–ª–æ–º, –∫—Ç–æ –º–µ–Ω—è –ø–æ–π–º—ë—Ç?"},
{"q": "–ö—Ç–æ —á–∞—â–µ —Å—Ç–∞–≤–∏—Ç –ª–∞–π–∫–∏ –Ω–∞ —Å—Ç–æ—Ä–∏—Å?"},
{"q": "–ï—Å–ª–∏ —á—Ç–æ-—Ç–æ –ø–æ—à–ª–æ –Ω–µ —Ç–∞–∫, –∫—Ç–æ –±—ã—Å—Ç—Ä–µ–µ —Å–¥–∞—ë—Ç—Å—è?"},
{"q": "–ö—Ç–æ –∏–∑ –Ω–∞—Å –±–æ–ª—å—à–µ –ª—é–±–∏—Ç –ø—Ä–∏–∫–ª—é—á–µ–Ω–∏—è?"},
{"q": "–ö—Ç–æ –ª—É—á—à–µ —Ö—Ä–∞–Ω–∏—Ç —Å–µ–∫—Ä–µ—Ç—ã?"},
{"q": "–ï—Å–ª–∏ –∫—Ç–æ-—Ç–æ —Å–∫—É—á–∞–µ—Ç, –∫—Ç–æ –ø–µ—Ä–≤—ã–º –Ω–∞–ø–∏—à–µ—Ç?"},
{"q": "–ö—Ç–æ —á–∞—â–µ –¥–µ–ª–∞–µ—Ç —Å–º–µ—à–Ω—ã–µ —Å–µ–ª—Ñ–∏?"},
{"q": "–ö—Ç–æ —á–∞—â–µ —Å–ø–æ—Ä–∏—Ç –æ —Ñ–∏–ª—å–º–∞—Ö?"},
{"q": "–ö—Ç–æ –±—ã—Å—Ç—Ä–µ–µ –æ—Ç–≤–µ—á–∞–µ—Ç –Ω–∞ —Å–æ–æ–±—â–µ–Ω–∏—è?"},
{"q": "–ö—Ç–æ —á–∞—â–µ –±–µ—Ä—ë—Ç –∏–Ω–∏—Ü–∏–∞—Ç–∏–≤—É?"},
{"q": "–ï—Å–ª–∏ —è –≥—Ä—É—â—É, –∫—Ç–æ –º–µ–Ω—è —Ä–∞–∑–≤–µ—Å–µ–ª–∏—Ç?"},
{"q": "–ö—Ç–æ –±—ã—Å—Ç—Ä–µ–µ –Ω–∞—á–∏–Ω–∞–µ—Ç —à—É—Ç–∏—Ç—å?"},
{"q": "–ï—Å–ª–∏ –∏–¥—ë–º –≤ –º–∞–≥–∞–∑–∏–Ω, –∫—Ç–æ –±–æ–ª—å—à–µ –ø–æ–∫—É–ø–∞–µ—Ç?"},
{"q": "–ö—Ç–æ —á–∞—â–µ –æ—Ä–≥–∞–Ω–∏–∑—É–µ—Ç –≤—Å—Ç—Ä–µ—á–∏?"},
{"q": "–ö—Ç–æ —á–∞—â–µ –æ–ø–∞–∑–¥—ã–≤–∞–µ—Ç –Ω–∞ –≤—Å—Ç—Ä–µ—á–∏?"},
{"q": "–ö—Ç–æ —Å–º–µ—à–Ω–µ–µ —à—É—Ç–∏—Ç?"},
{"q": "–ö—Ç–æ –ª—É—á—à–µ –∑–∞–ø–æ–º–∏–Ω–∞–µ—Ç –∏–º–µ–Ω–∞?"},
{"q": "–ö—Ç–æ —á–∞—â–µ –ø—Ä–µ–¥–ª–∞–≥–∞–µ—Ç –∏–¥–µ–∏?"},
{"q": "–ö—Ç–æ —Å–∏–ª—å–Ω–µ–µ –≤–ª–∏—è–µ—Ç –Ω–∞ –¥—Ä—É–≥–∏—Ö?"},
{"q": "–ö—Ç–æ –±—ã—Å—Ç—Ä–µ–µ –Ω–∞—Ö–æ–¥–∏—Ç –º–µ–º—ã?"},
{"q": "–ö—Ç–æ —á–∞—â–µ –¥–µ–ª–∞–µ—Ç –∫–æ–º–ø–ª–∏–º–µ–Ω—Ç—ã?"},
{"q": "–ö—Ç–æ –±—ã—Å—Ç—Ä–µ–µ –æ—Å–≤–∞–∏–≤–∞–µ—Ç –Ω–æ–≤—ã–µ –ø—Ä–∏–≤—ã—á–∫–∏?"},
{"q": "–ö—Ç–æ —á–∞—â–µ —à—É—Ç–∏—Ç –ø—Ä–æ –µ–¥—É?"},
{"q": "–ö—Ç–æ –≥—Ä–æ–º—á–µ —Å–º–µ—ë—Ç—Å—è –Ω–∞–¥ –º–µ–º–∞–º–∏?"},
{"q": "–ö—Ç–æ —á–∞—â–µ —Ç–µ—Ä—è–µ—Ç –≤–µ—â–∏?"},
{"q": "–ö—Ç–æ –∏–∑ –Ω–∞—Å –±–æ–ª—å—à–µ —Å–ø–æ–Ω—Ç–∞–Ω–Ω—ã–π?"},
{"q": "–ö—Ç–æ —á–∞—â–µ –ø–∏—à–µ—Ç –ø–µ—Å–Ω–∏/—Å—Ç–∏—Ö–∏/—à—É—Ç–∫–∏?"},
{"q": "–ö—Ç–æ –±—ã—Å—Ç—Ä–µ–µ —Ä–µ–∞–≥–∏—Ä—É–µ—Ç –Ω–∞ –Ω–æ–≤–æ—Å—Ç–∏?"},
{"q": "–ö—Ç–æ —á–∞—â–µ –¥–µ–ª–∞–µ—Ç –Ω–µ–æ–±—ã—á–Ω—ã–µ –ø–æ–∫—É–ø–∫–∏?"},
{"q": "–ö—Ç–æ –ª—É—á—à–µ –≥–æ—Ç–æ–≤ –¥–µ–ª–∏—Ç—å—Å—è?"},
{"q": "–ö—Ç–æ —á–∞—â–µ –∑–∞–±—ã–≤–∞–µ—Ç –¥–Ω–∏ —Ä–æ–∂–¥–µ–Ω–∏—è?"},
{"q": "–ö—Ç–æ —á–∞—â–µ –±–µ—Ä—ë—Ç –∏–Ω–∏—Ü–∏–∞—Ç–∏–≤—É –≤ —Ä–∞–∑–≥–æ–≤–æ—Ä–∞—Ö?"},
{"q": "–ö—Ç–æ –≥—Ä–æ–º—á–µ —Ä–µ–∞–≥–∏—Ä—É–µ—Ç –Ω–∞ –º–µ–º—ã?"},
{"q": "–ö—Ç–æ —á–∞—â–µ —à—É—Ç–∏—Ç –ø—Ä–æ —Ä–∞–±–æ—Ç—É?"},
{"q": "–ö—Ç–æ –±–æ–ª—å—à–µ –ª—é–±–∏—Ç —Å–ø–æ–Ω—Ç–∞–Ω–Ω—ã–µ –≤–µ—á–µ—Ä–∏–Ω–∫–∏?"},
{"q": "–ö—Ç–æ —á–∞—â–µ –¥–µ–ª–∞–µ—Ç –∫–æ–º–ø–ª–∏–º–µ–Ω—Ç—ã –Ω–µ–∑–Ω–∞–∫–æ–º—Ü–∞–º?"},
{"q": "–ö—Ç–æ –ª—É—á—à–µ –∑–Ω–∞–µ—Ç –∏—Å—Ç–æ—Ä–∏–∏ –¥—Ä—É–≥ –¥—Ä—É–≥–∞?"},
{"q": "–ö—Ç–æ —á–∞—â–µ —Å–º–µ—ë—Ç—Å—è –Ω–∞–¥ —Å–æ–±–æ–π?"}
]

QUESTIONS_COFFEE = [
{"q": "–ï—Å–ª–∏ –º—ã –Ω–µ –∑–Ω–∞–∫–æ–º—ã, –∞ —Ç–µ–±–µ –¥–∞—é—Ç –∫–æ–º–ø–ª–∏–º–µ–Ω—Ç?"},
{"q": "–¢—ã –ø—Ä–∏—à–ª–∞ –Ω–∞ –∫–æ—Ñ–µ –∏ –≤–∏–¥–∏—à—å –Ω–æ–≤—ã–π –¥–µ—Å–µ—Ä—Ç ‚Äî —á—Ç–æ —Å–¥–µ–ª–∞–µ—à—å?"},
{"q": "–ï—Å–ª–∏ —É–≤–∏–¥–∏—à—å –Ω–µ–∑–Ω–∞–∫–æ–º—Ü–∞ —Å —Ç–∞–∫–æ–π –∂–µ —Å—É–º–∫–æ–π, —á—Ç–æ –ø–æ–¥—É–º–∞–µ—à—å?"},
{"q": "–¢–≤–æ–π –ª—É—á—à–∏–π —Å–ø–æ—Å–æ–± –ø–æ–∑–Ω–∞–∫–æ–º–∏—Ç—å—Å—è —Å –Ω–æ–≤—ã–º–∏ –ª—é–¥—å–º–∏?"},
{"q": "–ß—Ç–æ —Å–∫–∞–∑–∞—Ç—å –≤ –ø–µ—Ä–≤–æ–º —Ä–∞–∑–≥–æ–≤–æ—Ä–µ, —á—Ç–æ–±—ã –Ω–µ –∫–∞–∑–∞—Ç—å—Å—è —Å–∫—É—á–Ω–æ–π?"},
{"q": "–ï—Å–ª–∏ –≤ –≥—Ä—É–ø–ø–µ –∫—Ç–æ-—Ç–æ —Å—Ç—Ä–∞–Ω–Ω—ã–π, –∫–∞–∫ —Ä–µ–∞–≥–∏—Ä—É–µ—à—å?"},
{"q": "–ö—Ç–æ –±—ã—Å—Ç—Ä–µ–µ —Å—Ç–∞–Ω–µ—Ç —Ç–≤–æ–µ–π –ø–æ–¥—Ä—É–≥–æ–π?"},
{"q": "–ß—Ç–æ –ø—Ä–µ–¥–ø–æ—á—Ç—ë—à—å –Ω–∞ –ø–µ—Ä–≤–æ–º –∑–Ω–∞–∫–æ–º—Å—Ç–≤–µ?"},
{"q": "–ï—Å–ª–∏ –∫—Ç–æ-—Ç–æ —Å–ø—Ä–æc–∏—Ç –ø—Ä–æ —Ç–≤–æ—é —Ä–∞–±–æ—Ç—É?"},
{"q": "–ö–∞–∫–æ–π –ª—É—á—à–∏–π —Å–ø–æ—Å–æ–± —Å–ª–æ–º–∞—Ç—å –ª–µ–¥?"},
{"q": "–ö—Ç–æ —á–∞—â–µ –∑–∞–¥–∞—ë—Ç –≤–æ–ø—Ä–æ—Å—ã –ø–µ—Ä–≤—ã–º?"},
{"q": "–ß—Ç–æ –ø—Ä–µ–¥–ø–æ—á—Ç—ë—à—å –¥–ª—è –Ω–µ–ø—Ä–∏–Ω—É–∂–¥—ë–Ω–Ω–æ–π –±–µ—Å–µ–¥—ã?"},
{"q": "–ï—Å–ª–∏ —è —Ä–∞—Å—Å–∫–∞–∂—É —Å–º–µ—à–Ω—É—é –∏—Å—Ç–æ—Ä–∏—é, –∫–∞–∫ —Ä–µ–∞–≥–∏—Ä—É–µ—à—å?"},
{"q": "–ö—Ç–æ –±—ã—Å—Ç—Ä–µ–µ —Ä–∞—Å–∫—Ä–æ–µ—Ç—Å—è –≤ –∫–æ–º–ø–∞–Ω–∏–∏?"},
{"q": "–ï—Å–ª–∏ –∫—Ç–æ-—Ç–æ –æ–ø–æ–∑–¥–∞–µ—Ç –Ω–∞ –≤—Å—Ç—Ä–µ—á—É, —á—Ç–æ —Å–∫–∞–∂–µ—à—å?"},
{"q": "–ö—Ç–æ —á–∞—â–µ –ø—Ä–µ–¥–ª–∞–≥–∞–µ—Ç –∏–¥–µ–∏ –¥–ª—è —Ä–∞–∑–≥–æ–≤–æ—Ä–∞?"},
{"q": "–ö—Ç–æ —Å–º–µ—ë—Ç—Å—è –≥—Ä–æ–º—á–µ –≤—Å–µ–≥–æ?"},
{"q": "–ö–∞–∫–æ–µ –ø–µ—Ä–≤–æ–µ –≤–ø–µ—á–∞—Ç–ª–µ–Ω–∏–µ –ª—É—á—à–µ –ø—Ä–æ–∏–∑–≤–µ—Å—Ç–∏?"},
{"q": "–ï—Å–ª–∏ –∫—Ç–æ-—Ç–æ —Ä–∞—Å—Å–∫–∞–∂–µ—Ç —Å–µ–∫—Ä–µ—Ç, –∫–∞–∫ —Ä–µ–∞–≥–∏—Ä—É–µ—à—å?"},
{"q": "–ö—Ç–æ –±—ã—Å—Ç—Ä–µ–µ –∑–∞–≤–æ–¥–∏—Ç —Ä–∞–∑–≥–æ–≤–æ—Ä?"},
{"q": "–ö—Ç–æ —á–∞—â–µ –¥–µ–ª–∏—Ç—Å—è —Å–º–µ—à–Ω—ã–º–∏ –∏—Å—Ç–æ—Ä–∏—è–º–∏?"},
{"q": "–ï—Å–ª–∏ –∫—Ç–æ-—Ç–æ –º–æ–ª—á–∏—Ç, –∫–∞–∫ —Ä–∞–∑—Ä—è–¥–∏—Ç—å –∞—Ç–º–æ—Å—Ñ–µ—Ä—É?"},
{"q": "–ß—Ç–æ —Å–∫–∞–∂–µ—à—å –ø—Ä–∏ –Ω–µ–ª–æ–≤–∫–æ–π –ø–∞—É–∑–µ?"},
{"q": "–ö–∞–∫ –ª—É—á—à–µ –ø–æ–∑–Ω–∞–∫–æ–º–∏—Ç—å—Å—è —Å –Ω–æ–≤—ã–º–∏ –ª—é–¥—å–º–∏?"},
{"q": "–ö—Ç–æ —á–∞—â–µ —Ä–µ–∞–≥–∏—Ä—É–µ—Ç –Ω–∞ –º–µ–º—ã?"},
{"q": "–ï—Å–ª–∏ –∫—Ç–æ-—Ç–æ —Ä–∞—Å—Å–∫–∞–∂–µ—Ç –æ –ø—É—Ç–µ—à–µ—Å—Ç–≤–∏–∏, –∫–∞–∫ —Ä–µ–∞–≥–∏—Ä—É–µ—à—å?"},
{"q": "–ö—Ç–æ –±—ã—Å—Ç—Ä–µ–µ —Å–æ–≥–ª–∞—à–∞–µ—Ç—Å—è –Ω–∞ –ø—Ä–∏–≥–ª–∞—à–µ–Ω–∏–µ?"},
{"q": "–ö—Ç–æ —á–∞—â–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç —Ä–∞–∑–≥–æ–≤–æ—Ä?"},
{"q": "–ï—Å–ª–∏ –∫—Ç–æ-—Ç–æ —Ä–∞—Å—Å–∫–∞–∂–µ—Ç —Å–º–µ—à–Ω–æ–π —Å–ª—É—á–∞–π –∏–∑ –∂–∏–∑–Ω–∏?"},
{"q": "–ö–∞–∫ —Ä–µ–∞–≥–∏—Ä—É–µ—à—å –Ω–∞ —Å—Ç—Ä–∞–Ω–Ω—ã–µ –ø—Ä–∏–≤—ã—á–∫–∏ –Ω–æ–≤—ã—Ö –ª—é–¥–µ–π?"},
{"q": "–ö—Ç–æ —á–∞—â–µ –ø—Ä–æ—è–≤–ª—è–µ—Ç –∏–Ω–∏—Ü–∏–∞—Ç–∏–≤—É –≤ –∑–Ω–∞–∫–æ–º—Å—Ç–≤–∞—Ö?"},
{"q": "–ß—Ç–æ —Å–∫–∞–∂–µ—à—å –ø—Ä–∏ –∑–Ω–∞–∫–æ–º—Å—Ç–≤–µ —Å –Ω–µ—Å–∫–æ–ª—å–∫–∏–º–∏ –ª—é–¥—å–º–∏ —Å—Ä–∞–∑—É?"},
{"q": "–ö—Ç–æ –±—ã—Å—Ç—Ä–µ–µ —Å–±–ª–∏–∂–∞–µ—Ç—Å—è —Å –Ω–æ–≤—ã–º–∏ –ª—é–¥—å–º–∏?"},
{"q": "–ï—Å–ª–∏ –∫—Ç–æ-—Ç–æ —Å–ª–∏—à–∫–æ–º —Å–µ—Ä—å—ë–∑–Ω—ã–π, –∫–∞–∫ —Ä–µ–∞–≥–∏—Ä—É–µ—à—å?"},
{"q": "–ö—Ç–æ —á–∞—â–µ —Å–º–µ—ë—Ç—Å—è –Ω–∞–¥ –Ω–µ–ª–æ–≤–∫–æ—Å—Ç—å—é?"},
{"q": "–ö—Ç–æ –±—ã—Å—Ç—Ä–µ–µ –Ω–∞—á–∏–Ω–∞–µ—Ç –¥–æ–≤–µ—Ä—è—Ç—å –Ω–æ–≤—ã–º –ª—é–¥—è–º?"},
{"q": "–ï—Å–ª–∏ –∫—Ç–æ-—Ç–æ —Ä–∞—Å—Å–∫–∞–∂–µ—Ç —Å–µ–∫—Ä–µ—Ç, –∫–∞–∫ —Ä–µ–∞–≥–∏—Ä—É–µ—à—å?"},
{"q": "–ö—Ç–æ —á–∞—â–µ –±–µ—Ä—ë—Ç –∏–Ω–∏—Ü–∏–∞—Ç–∏–≤—É –≤ —Ä–∞–∑–≥–æ–≤–æ—Ä–µ?"},
{"q": "–ï—Å–ª–∏ –∫—Ç–æ-—Ç–æ —Ä–∞—Å—Å–∫–∞–∂–µ—Ç –∞–Ω–µ–∫–¥–æ—Ç, –∫—Ç–æ —Å–º–µ—ë—Ç—Å—è –ø–µ—Ä–≤—ã–º?"},
{"q": "–ö—Ç–æ –±—ã—Å—Ç—Ä–µ–µ –≤–æ–≤–ª–µ–∫–∞–µ—Ç—Å—è –≤ –±–µ—Å–µ–¥—É?"},
{"q": "–ö—Ç–æ —á–∞—â–µ –¥–µ–ª–∞–µ—Ç –∫–æ–º–ø–ª–∏–º–µ–Ω—Ç—ã –Ω–æ–≤—ã–º –ª—é–¥—è–º?"},
{"q": "–ö—Ç–æ –±—ã—Å—Ç—Ä–µ–µ –¥–µ–ª–∏—Ç—Å—è –∏—Å—Ç–æ—Ä–∏–µ–π –æ —Å–µ–±–µ?"},
{"q": "–ï—Å–ª–∏ –∫—Ç–æ-—Ç–æ —Ä–∞—Å—Å–∫–∞–∂–µ—Ç –Ω–µ–ª–æ–≤–∫–∏–π –º–æ–º–µ–Ω—Ç, –∫–∞–∫ —Ä–µ–∞–≥–∏—Ä—É–µ—à—å?"},
{"q": "–ö—Ç–æ —á–∞—â–µ –∑–∞–¥–∞—ë—Ç –≤–æ–ø—Ä–æ—Å—ã –ø–µ—Ä–≤—ã–º?"},
{"q": "–ö—Ç–æ –±—ã—Å—Ç—Ä–µ–µ –æ—Ç–∫—Ä–æ–µ—Ç—Å—è –≤ –∫–æ–º–ø–∞–Ω–∏–∏ –Ω–æ–≤—ã—Ö –ª—é–¥–µ–π?"},
{"q": "–ö—Ç–æ —á–∞—â–µ —Å–º–µ—ë—Ç—Å—è –Ω–∞–¥ —à—É—Ç–∫–∞–º–∏ –Ω–µ–∑–Ω–∞–∫–æ–º—ã—Ö –ª—é–¥–µ–π?"},
{"q": "–ö—Ç–æ –±—ã—Å—Ç—Ä–µ–µ –∑–∞–≤–æ–¥–∏—Ç —Ä–∞–∑–≥–æ–≤–æ—Ä —Å –Ω–æ–≤—ã–º–∏ –ª—é–¥—å–º–∏?"},
{"q": "–ï—Å–ª–∏ –∫—Ç–æ-—Ç–æ —Ä–∞—Å—Å–∫–∞–∂–µ—Ç –∏—Å—Ç–æ—Ä–∏—é, –∫—Ç–æ –±—ã—Å—Ç—Ä–µ–µ –æ—Ç—Ä–µ–∞–≥–∏—Ä—É–µ—Ç?"},
{"q": "–ö—Ç–æ –±—ã—Å—Ç—Ä–µ–µ –≤–∫–ª—é—á–∞–µ—Ç—Å—è –≤ –≥—Ä—É–ø–ø–æ–≤—É—é –±–µ—Å–µ–¥—É?"},
{"q": "–ö—Ç–æ —á–∞—â–µ —Å–º–µ—ë—Ç—Å—è –Ω–∞–¥ —à—É—Ç–∫–∞–º–∏ –¥—Ä—É–≥–∏—Ö?"}
]

FUN_COMMENTS = [
    "üòÇ –ö—Ç–æ-—Ç–æ —è–≤–Ω–æ —Å–µ–≥–æ–¥–Ω—è –≤ —É–¥–∞—Ä–µ!",
    "ü§£ –ù–µ –º–æ–≥—É –ø–æ–≤–µ—Ä–∏—Ç—å, —á—Ç–æ –∫—Ç–æ-—Ç–æ —Å–∫–∞–∑–∞–ª —ç—Ç–æ –≤—Å–µ—Ä—å—ë–∑!",
    "üòé –û—Ç–ª–∏—á–Ω—ã–µ –æ—Ç–≤–µ—Ç—ã, –ø–æ—Ö–æ–∂–µ, –º—ã –≤—Å–µ—Ö —É–¥–∏–≤–∏–ª–∏!",
    "üòú –•–∞-—Ö–∞, –≤–æ—Ç —ç—Ç–æ –ø–æ–≤–æ—Ä–æ—Ç!",
    "ü§™ –°–º–µ—à–Ω–µ–µ –Ω–µ –±—ã–≤–∞–µ—Ç!",
    "üòè –ö—Ç–æ-—Ç–æ —Ö–∏—Ç—Ä–∏—Ç, –Ω–æ –º—ã –≤–∏–¥–∏–º —ç—Ç–æ!",
    "üòÜ –Ø –¥–∞–∂–µ –Ω–µ –∑–Ω–∞—é, —á—Ç–æ —Å–∫–∞–∑–∞—Ç—å‚Ä¶",
    "ü•≥ –í–æ—Ç —ç—Ç–æ –ø–æ–≤–µ—Å–µ–ª–∏–ª–∏ –≤—Å–µ—Ö!"
]

# =======================
# –°–û–°–¢–û–Ø–ù–ò–ï –ò–ì–†–´
# =======================

GAMES = {}  # chat_id -> game_state

class GameState:
    def __init__(self, chat_id, mode):
        self.chat_id = chat_id
        self.mode = mode
        self.players = []  # [{"name": "–ê–Ω—è", "answered": False}]
        self.q_index = 0
        self.waiting_for_players = True
        self.waiting_for_ready = False
        self.optional_names = False
        self.sent_messages = []

# =======================
# –ö–ù–û–ü–ö–ò
# =======================

def mode_keyboard():
    buttons = [
        [InlineKeyboardButton("üç∑ –ú–æ—è –ë–µ—Å—Ç–∏—è", callback_data="mode_bestia")],
        [InlineKeyboardButton("‚òï –ú–µ–∂–¥—É –Ω–∞–º–∏, –¥–µ–≤–æ—á–∫–∞–º–∏", callback_data="mode_coffee")]
    ]
    return InlineKeyboardMarkup(buttons)

def ready_keyboard():
    return InlineKeyboardMarkup([[InlineKeyboardButton("‚úÖ –ì–û–¢–û–í–û", callback_data="ready_game")]])

# =======================
# –•–≠–ù–î–õ–ï–†–´
# =======================

async def start(update: Update, context: ContextTypes.DEFAULT_TYPE):
    await update.message.reply_text(
        "–ü—Ä–∏–≤–µ—Ç! üíñ –≠—Ç–æ –∏–≥—Ä–∞ –¥–ª—è –¥–µ–≤–æ—á–µ–∫ üéâ\n\n"
        "–ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è:\n"
        "1Ô∏è‚É£ –í—ã–±–µ—Ä–∏—Ç–µ —Ä–µ–∂–∏–º: –ú–æ—è –ë–µ—Å—Ç–∏—è –∏–ª–∏ –ú–µ–∂–¥—É –Ω–∞–º–∏, –¥–µ–≤–æ—á–∫–∞–º–∏\n"
        "2Ô∏è‚É£ –í–≤–µ–¥–∏—Ç–µ –∏–º–µ–Ω–∞ –≤—Å–µ—Ö —É—á–∞—Å—Ç–Ω–∏—Ü —á–µ—Ä–µ–∑ –∑–∞–ø—è—Ç—É—é (–º–∏–Ω 2, –º–∞–∫—Å 10) ‚Äî –∏–ª–∏ –ø—Ä–æ—Å—Ç–æ –Ω–∞–∂–º–∏—Ç–µ –ì–û–¢–û–í–û, –µ—Å–ª–∏ –Ω–µ —Ö–æ—Ç–∏—Ç–µ –≤–≤–æ–¥–∏—Ç—å\n"
        "3Ô∏è‚É£ –ù–∞–∂–º–∏—Ç–µ ‚úÖ –ì–û–¢–û–í–û, –∫–æ–≥–¥–∞ –≤—Å–µ –≥–æ—Ç–æ–≤—ã\n"
        "4Ô∏è‚É£ –ë–æ—Ç –∑–∞–¥–∞—ë—Ç –≤–æ–ø—Ä–æ—Å—ã, –≤—Å–µ –æ—Ç–≤–µ—á–∞—é—Ç —Å–≤–æ–∏–º–∏ —Å–ª–æ–≤–∞–º–∏\n"
        "5Ô∏è‚É£ –ü–æ—Å–ª–µ –∫–∞–∂–¥–æ–≥–æ –≤–æ–ø—Ä–æ—Å–∞ –±–æ—Ç –¥–æ–±–∞–≤–ª—è–µ—Ç —Å–º–µ—à–Ω–æ–π –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π\n\n"
        "/newgame ‚Äî –Ω–∞—á–∞—Ç—å –Ω–æ–≤—É—é –∏–≥—Ä—É"
    )

async def newgame(update: Update, context: ContextTypes.DEFAULT_TYPE):
    chat_id = update.effective_chat.id
    await update.message.reply_text("–í—ã–±–µ—Ä–∏—Ç–µ —Ä–µ–∂–∏–º –∏–≥—Ä—ã:", reply_markup=mode_keyboard())

async def mode_choice(update: Update, context: ContextTypes.DEFAULT_TYPE):
    query = update.callback_query
    await query.answer()
    chat_id = query.message.chat.id

    mode = "bestia" if query.data == "mode_bestia" else "coffee"
    GAMES[chat_id] = GameState(chat_id, mode)

    await query.edit_message_text(
        f"–í—ã –≤—ã–±—Ä–∞–ª–∏ —Ä–µ–∂–∏–º: {'üç∑ –ú–æ—è –ë–µ—Å—Ç–∏—è' if mode=='bestia' else '‚òï –ú–µ–∂–¥—É –Ω–∞–º–∏, –¥–µ–≤–æ—á–∫–∞–º–∏'}\n\n"
        "–í–≤–µ–¥–∏—Ç–µ –∏–º–µ–Ω–∞ –≤—Å–µ—Ö —É—á–∞—Å—Ç–Ω–∏—Ü —á–µ—Ä–µ–∑ –∑–∞–ø—è—Ç—É—é (–º–∏–Ω 2, –º–∞–∫—Å 10),\n–∏–ª–∏ –ø—Ä–æ—Å—Ç–æ –Ω–∞–∂–º–∏—Ç–µ ‚úÖ –ì–û–¢–û–í–û, –µ—Å–ª–∏ –Ω–µ —Ö–æ—Ç–∏—Ç–µ –≤–≤–æ–¥–∏—Ç—å –∏–º–µ–Ω–∞.",
        reply_markup=ready_keyboard()
    )

async def handle_players(update: Update, context: ContextTypes.DEFAULT_TYPE):
    chat_id = update.effective_chat.id
    if chat_id not in GAMES:
        return
    game = GAMES[chat_id]
    if not game.waiting_for_players:
        return

    text = update.message.text.strip()
    if text:
        names = [name.strip() for name in text.split(",") if name.strip()]
        if len(names) < 2 or len(names) > 10:
            await update.message.reply_text("–ù—É–∂–Ω–æ –≤–≤–µ—Å—Ç–∏ –æ—Ç 2 –¥–æ 10 –∏–º—ë–Ω —á–µ—Ä–µ–∑ –∑–∞–ø—è—Ç—É—é, –∏–ª–∏ –Ω–∞–∂–º–∏—Ç–µ –ì–û–¢–û–í–û.")
            return
        game.players = [{"name": n, "answered": False} for n in names]
    else:
        game.players = []
        game.optional_names = True

    game.waiting_for_players = False
    game.waiting_for_ready = True
    await update.message.reply_text(
        f"–£—á–∞—Å—Ç–Ω–∏—Ü—ã –¥–æ–±–∞–≤–ª–µ–Ω—ã: {', '.join([p['name'] for p in game.players]) if game.players else '–ò–º–µ–Ω–∞ –Ω–µ –≤–≤–µ–¥–µ–Ω—ã'}\n"
        "–ö–æ–≥–¥–∞ –≤—Å–µ –≥–æ—Ç–æ–≤—ã, –Ω–∞–∂–º–∏—Ç–µ ‚úÖ –ì–û–¢–û–í–û",
        reply_markup=ready_keyboard()
    )

async def ready_game(update: Update, context: ContextTypes.DEFAULT_TYPE):
    query = update.callback_query
    await query.answer()
    chat_id = query.message.chat.id
    game = GAMES.get(chat_id)
    if not game or not game.waiting_for_ready:
        return

    game.waiting_for_ready = False
    await send_question(chat_id, context)

async def send_question(chat_id, context: ContextTypes.DEFAULT_TYPE):
    game = GAMES[chat_id]
    questions = QUESTIONS_BESTIA if game.mode == "bestia" else QUESTIONS_COFFEE
    if game.q_index >= len(questions):
        await context.bot.send_message(chat_id, "‚úÖ –ò–≥—Ä–∞ –∑–∞–∫–æ–Ω—á–µ–Ω–∞! –°–ø–∞—Å–∏–±–æ –∑–∞ —É—á–∞—Å—Ç–∏–µ üéâ")
        for msg_id in game.sent_messages:
            try:
                await context.bot.delete_message(chat_id, msg_id)
            except:
                pass
        GAMES.pop(chat_id)
        return

    question = questions[game.q_index]["q"]
    for player in game.players:
        player["answered"] = False

    players_list = ""
    if game.players:
        players_list = "\n".join([f"- {p['name']} ‚ùå" for p in game.players])
    else:
        players_list = "–í—Å–µ —É—á–∞—Å—Ç–Ω–∏–∫–∏, –∫–æ—Ç–æ—Ä—ã–µ –æ—Ç–≤–µ—á–∞—é—Ç, —Å—á–∏—Ç–∞—é—Ç—Å—è –≤ –∏–≥—Ä–µ!"

    msg = await context.bot.send_message(
        chat_id,
        f"–í–æ–ø—Ä–æ—Å {game.q_index +1}: {question}\n\n"
        f"{players_list}\n\n"
        "–í—Å–µ –æ—Ç–≤–µ—á–∞—é—Ç —Å–≤–æ–∏–º–∏ —Å–ª–æ–≤–∞–º–∏ –≤ —á–∞—Ç–µ –∏–ª–∏ —É—Å—Ç–Ω–æ! üé§"
    )
    game.sent_messages.append(msg.message_id)

async def handle_answer_message(update: Update, context: ContextTypes.DEFAULT_TYPE):
    chat_id = update.effective_chat.id
    if chat_id not in GAMES:
        return
    game = GAMES[chat_id]

    if game.players and not game.optional_names:
        updated = False
        for player in game.players:
            if update.message.from_user.first_name == player["name"] and not player["answered"]:
                player["answered"] = True
                updated = True

        if updated:
            players_list = "\n".join([f"- {p['name']} {'‚úÖ' if p['answered'] else '‚ùå'}" for p in game.players])
            await context.bot.send_message(chat_id, f"–û—Ç–≤–µ—Ç –ø–æ–ª—É—á–µ–Ω! –°—Ç–∞—Ç—É—Å:\n{players_list}")

        if all(p["answered"] for p in game.players):
            comment = random.choice(FUN_COMMENTS)
            msg = await context.bot.send_message(chat_id, f"–í—Å–µ –æ—Ç–≤–µ—Ç–∏–ª–∏! {comment}")
            game.sent_messages.append(msg.message_id)
            game.q_index +=1
            await send_question(chat_id, context)
    else:
        comment = random.choice(FUN_COMMENTS)
        msg = await context.bot.send_message(chat_id, comment)
        game.sent_messages.append(msg.message_id)
        game.q_index +=1
        await send_question(chat_id, context)

# =======================
# –ó–ê–ü–£–°–ö
# =======================
def main():
    token = os.getenv("BOT_TOKEN")
    if not token:
        raise RuntimeError("BOT_TOKEN not set")

    app = Application.builder().token(token).build()

    app.add_handler(CommandHandler("start", start))
    app.add_handler(CommandHandler("newgame", newgame))
    app.add_handler(CallbackQueryHandler(mode_choice, pattern="mode_.*"))
    app.add_handler(MessageHandler(filters.TEXT & ~filters.COMMAND, handle_players))
    app.add_handler(CallbackQueryHandler(ready_game, pattern="ready_game"))
    app.add_handler(MessageHandler(filters.TEXT & ~filters.COMMAND, handle_answer_message))

    app.run_polling()

if __name__ == "__main__":
    main()

