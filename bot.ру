import os
import random
from dataclasses import dataclass, field
from typing import Dict, List

from telegram import Update, InlineKeyboardButton, InlineKeyboardMarkup
from telegram.ext import (
    Application,
    CommandHandler,
    CallbackQueryHandler,
    MessageHandler,
    ContextTypes,
    filters,
)

# ======================
# –†–ï–ñ–ò–ú–´
# ======================

MODE_BESTIA = "bestia"
MODE_COFFEE = "coffee"

# ======================
# –í–û–ü–†–û–°–´ (50 –Ω–∞ —Ä–µ–∂–∏–º)
# ======================

QUESTIONS = {
    MODE_BESTIA: [
        "–¢—ã —á–∞—â–µ –ø—Ä–∏—Ç–≤–æ—Ä—è–µ—à—å—Å—è –º–∏–ª–æ–π –∏–ª–∏ —Å—Ä–∞–∑—É –ø–æ–∫–∞–∑—ã–≤–∞–µ—à—å —Ö–∞—Ä–∞–∫—Ç–µ—Ä?",
        "–¢—ã –∏–∑ —Ç–µ—Ö, –∫—Ç–æ –≥–æ–≤–æ—Ä–∏—Ç ¬´–º–Ω–µ –≤—Å—ë —Ä–∞–≤–Ω–æ¬ª, –Ω–æ –Ω–µ –≤—Å—ë —Ä–∞–≤–Ω–æ?",
        "–¢—ã –ª—é–±–∏—à—å –±—ã—Ç—å –ø—Ä–∞–≤–æ–π –∏–ª–∏ —á—Ç–æ–±—ã –≤—Å–µ –ø–æ–Ω—è–ª–∏, —á—Ç–æ —Ç—ã –±—ã–ª–∞ –ø—Ä–∞–≤–∞?",
        "–¢—ã –±—ã—Å—Ç—Ä–µ–µ –∑–∞–≤–æ–¥–∏—à—å—Å—è –∏–ª–∏ –±—ã—Å—Ç—Ä–µ–µ –æ—Å—Ç—ã–≤–∞–µ—à—å?",
        "–¢—ã —É–º–µ–µ—à—å —Å–∫—Ä—ã–≤–∞—Ç—å —Ä–∞–∑–¥—Ä–∞–∂–µ–Ω–∏–µ?",
        "–¢—ã —á–∞—â–µ –¥–µ–π—Å—Ç–≤—É–µ—à—å –Ω–∞ —ç–º–æ—Ü–∏—è—Ö –∏–ª–∏ –Ω–∞ –∞–≤—Ç–æ–º–∞—Ç–µ?",
        "–¢—ã –∏–∑ —Ç–µ—Ö, –∫—Ç–æ –≤—Å—ë –∑–∞–º–µ—á–∞–µ—Ç, –Ω–æ –º–æ–ª—á–∏—Ç?",
        "–¢—ã –ª—é–±–∏—à—å –∫–æ–Ω—Ç—Ä–æ–ª–∏—Ä–æ–≤–∞—Ç—å —Å–∏—Ç—É–∞—Ü–∏—é?",
        "–¢—ã –º–æ–∂–µ—à—å —Ä–µ–∑–∫–æ –ø–æ–º–µ–Ω—è—Ç—å –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∏–µ?",
        "–¢—ã —á–∞—â–µ —Å–º–µ—ë—à—å—Å—è –∏–ª–∏ –∑–∞–∫–∞—Ç—ã–≤–∞–µ—à—å –≥–ª–∞–∑–∞?",
        "–¢—ã –∏–∑ —Ç–µ—Ö, –∫—Ç–æ –º–æ–∂–µ—Ç –∏—Å–ø–æ—Ä—Ç–∏—Ç—å –∞—Ç–º–æ—Å—Ñ–µ—Ä—É –æ–¥–Ω–∏–º –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–µ–º?",
        "–¢—ã –ª–µ–≥–∫–æ –≤—ã—Ö–æ–¥–∏—à—å –∏–∑ —Å–µ–±—è?",
        "–¢—ã —á–∞—â–µ –ø—Ä–æ–≤–µ—Ä—è–µ—à—å –ª—é–¥–µ–π –∏–ª–∏ –¥–æ–≤–µ—Ä—è–µ—à—å —Å—Ä–∞–∑—É?",
        "–¢—ã –ª—é–±–∏—à—å –±—ã—Ç—å –≤ —Ü–µ–Ω—Ç—Ä–µ –≤–Ω–∏–º–∞–Ω–∏—è?",
        "–¢—ã –º–æ–∂–µ—à—å –±—ã—Ç—å —è–∑–≤–∏—Ç–µ–ª—å–Ω–æ–π?",
        "–¢—ã –∏–∑ —Ç–µ—Ö, –∫—Ç–æ –¥–æ–ª–≥–æ –ø–æ–º–Ω–∏—Ç —Å—Ç—Ä–∞–Ω–Ω—ã–µ –º–æ–º–µ–Ω—Ç—ã?",
        "–¢—ã —á–∞—â–µ –≥–æ–≤–æ—Ä–∏—à—å –ø—Ä—è–º–æ –∏–ª–∏ –Ω–∞–º—ë–∫–∞–º–∏?",
        "–¢—ã —É–º–µ–µ—à—å –¥–µ—Ä–∂–∞—Ç—å –ø–∞—É–∑—É?",
        "–¢—ã –±–æ–ª—å—à–µ –∑–∞ —Ö–∞–æ—Å –∏–ª–∏ –∑–∞ –ø–æ—Ä—è–¥–æ–∫?",
        "–¢—ã –ª—é–±–∏—à—å –Ω–µ–æ–∂–∏–¥–∞–Ω–Ω–æ—Å—Ç–∏?",
        "–¢—ã –∏–∑ —Ç–µ—Ö, –∫—Ç–æ —Å–Ω–∞—á–∞–ª–∞ –¥–µ–ª–∞–µ—Ç, –ø–æ—Ç–æ–º –¥—É–º–∞–µ—Ç?",
        "–¢—ã —á–∞—Å—Ç–æ –ø–µ—Ä–µ–∏–≥—Ä—ã–≤–∞–µ—à—å —Ä–∞–∑–≥–æ–≤–æ—Ä—ã –≤ –≥–æ–ª–æ–≤–µ?",
        "–¢—ã —É–º–µ–µ—à—å –≤–æ–≤—Ä–µ–º—è –æ—Å—Ç–∞–Ω–æ–≤–∏—Ç—å—Å—è?",
        "–¢—ã –ª—é–±–∏—à—å –æ—Å—Ç—Ä—ã–µ —à—É—Ç–∫–∏?",
        "–¢—ã –ª–µ–≥–∫–æ —Ä–∞–∑–¥—Ä–∞–∂–∞–µ—à—å—Å—è –Ω–∞ –º–µ–ª–æ—á–∏?",
        "–¢—ã –º–æ–∂–µ—à—å –±—ã—Ç—å —Ä–µ–∑–∫–æ–π, –µ—Å–ª–∏ —É—Å—Ç–∞–ª–∞?",
        "–¢—ã —á–∞—â–µ –ø–æ–¥—Å—Ç—Ä–∞–∏–≤–∞–µ—à—å—Å—è –∏–ª–∏ –Ω–∞—Å—Ç–∞–∏–≤–∞–µ—à—å?",
        "–¢—ã –∏–∑ —Ç–µ—Ö, –∫—Ç–æ —Å—Ä–∞–∑—É —á—É–≤—Å—Ç–≤—É–µ—Ç —Ñ–∞–ª—å—à—å?",
        "–¢—ã –ª—é–±–∏—à—å, –∫–æ–≥–¥–∞ –≤—Å—ë –∏–¥—ë—Ç –ø–æ —Ç–≤–æ–µ–º—É —Å—Ü–µ–Ω–∞—Ä–∏—é?",
        "–¢—ã —É–º–µ–µ—à—å –¥–µ–ª–∞—Ç—å –≤–∏–¥, —á—Ç–æ –≤—Å—ë –Ω–æ—Ä–º–∞–ª—å–Ω–æ?",
        "–¢—ã –∏–∑ —Ç–µ—Ö, –∫—Ç–æ –º–æ–∂–µ—Ç –≤–Ω–µ–∑–∞–ø–Ω–æ –∑–∞–º–æ–ª—á–∞—Ç—å?",
        "–¢—ã –±—ã—Å—Ç—Ä–æ –ø—Ä–∏–≤—è–∑—ã–≤–∞–µ—à—å—Å—è –∫ –ª—é–¥—è–º?",
        "–¢—ã —á–∞—â–µ —Å–æ–º–Ω–µ–≤–∞–µ—à—å—Å—è –∏–ª–∏ —É–≤–µ—Ä–µ–Ω–∞ –≤ —Å–µ–±–µ?",
        "–¢—ã –ª—é–±–∏—à—å —Å–ø–æ—Ä—ã?",
        "–¢—ã —É–º–µ–µ—à—å –±—ã—Ç—å –º—è–≥–∫–æ–π, –µ—Å–ª–∏ —Ö–æ—á–µ—à—å?",
        "–¢—ã —á–∞—â–µ –∑–∞—â–∏—â–∞–µ—à—å—Å—è –∏–ª–∏ –Ω–∞–ø–∞–¥–∞–µ—à—å?",
        "–¢—ã –º–æ–∂–µ—à—å –±—ã—Ç—å —Ö–æ–ª–æ–¥–Ω–æ–π —Å–ø–µ—Ü–∏–∞–ª—å–Ω–æ?",
        "–¢—ã –∏–∑ —Ç–µ—Ö, –∫—Ç–æ –ª–µ–≥–∫–æ –∑–∞–∂–∏–≥–∞–µ—Ç –∫–æ–º–ø–∞–Ω–∏—é?",
        "–¢—ã —É–º–µ–µ—à—å –ø–µ—Ä–µ–∫–ª—é—á–∞—Ç—å—Å—è?",
        "–° —Ç–æ–±–æ–π —Å–∫–æ—Ä–µ–µ –ª–µ–≥–∫–æ –∏–ª–∏ –∏–Ω—Ç–µ—Ä–µ—Å–Ω–æ?",
        "–¢—ã –∏–∑ —Ç–µ—Ö, –∫—Ç–æ –ª—é–±–∏—Ç –ø—Ä–æ–≤–æ—Ü–∏—Ä–æ–≤–∞—Ç—å?",
        "–¢—ã —É–º–µ–µ—à—å –ø–æ–¥—à—É—á–∏–≤–∞—Ç—å –Ω–∞–¥ –¥—Ä—É–∑—å—è–º–∏?",
        "–¢—ã –º–æ–∂–µ—à—å –±—ã—Ç—å —Å–∞—Ä–∫–∞—Å—Ç–∏—á–Ω–æ–π?",
        "–¢—ã –∏–∑ —Ç–µ—Ö, –∫—Ç–æ –ª—é–±–∏—Ç —É–¥–∏–≤–ª—è—Ç—å?",
        "–¢—ã –±—ã—Å—Ç—Ä–æ —Å—Ö–≤–∞—Ç—ã–≤–∞–µ—à—å —é–º–æ—Ä?",
        "–¢—ã –º–æ–∂–µ—à—å –¥–µ–ª–∞—Ç—å –≤–∏–¥, —á—Ç–æ –≤—Å—ë –Ω–æ—Ä–º–∞–ª—å–Ω–æ?",
        "–¢—ã –∏–∑ —Ç–µ—Ö, –∫—Ç–æ –ø–æ–º–Ω–∏—Ç —á—É–∂–∏–µ —à—É—Ç–∫–∏?",
        "–¢—ã –ª–µ–≥–∫–æ –∑–∞–≤–æ–¥–∏—à—å –Ω–æ–≤—ã–µ –∑–Ω–∞–∫–æ–º—Å—Ç–≤–∞?",
        "–¢—ã –∏–∑ —Ç–µ—Ö, –∫—Ç–æ –ª—é–±–∏—Ç —Å–æ—Ä–µ–≤–Ω–æ–≤–∞—Ç—å—Å—è?",
        "–¢—ã –º–æ–∂–µ—à—å —Å–º–µ—è—Ç—å—Å—è –Ω–∞–¥ —Å–æ–±–æ–π?",
        "–¢—ã –∏–∑ —Ç–µ—Ö, –∫—Ç–æ –ª—é–±–∏—Ç —Å—Ç–∞–≤–∏—Ç—å —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç—ã?",
        "–¢—ã –ª–µ–≥–∫–æ –ø–æ–¥–Ω–∏–º–∞–µ—à—å –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∏–µ –¥—Ä—É–≥–∏–º?",
    ],
    MODE_COFFEE: [
        "–ö—Ç–æ –∏–∑ –Ω–∞—Å –≤—ã–≥–ª—è–¥–∏—Ç —Å–∞–º–æ–π –Ω–µ–≤–∏–Ω–Ω–æ–π, –Ω–æ —Ç—ã –±—ã –µ–π –Ω–µ –¥–æ–≤–µ—Ä–∏–ª–∞ —Å–≤–æ–∏ —Å–µ–∫—Ä–µ—Ç—ã?",
        "–ö—Ç–æ –≤ —ç—Ç–æ–π –∫–æ–º–ø–∞–Ω–∏–∏ —Ç–æ—á–Ω–æ –ø–∏—à–µ—Ç —Å–æ–æ–±—â–µ–Ω–∏—è, –∞ –ø–æ—Ç–æ–º —Å—Ç–∏—Ä–∞–µ—Ç?",
        "–ö—Ç–æ –∑–¥–µ—Å—å –º–æ–∂–µ—Ç –º–∏–ª–æ —É–ª—ã–±–∞—Ç—å—Å—è –∏ –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ –æ—Å—É–∂–¥–∞—Ç—å?",
        "–ö—Ç–æ —Å–∫–æ—Ä–µ–µ –≤—Å–µ–≥–æ —Å–∫–∞–∂–µ—Ç ¬´—è –Ω–æ—Ä–º¬ª, –∫–æ–≥–¥–∞ –≤–æ–æ–±—â–µ –Ω–µ –Ω–æ—Ä–º?",
        "–ö—Ç–æ –∏–∑ –Ω–∞—Å –≤—ã–≥–ª—è–¥–∏—Ç —Ç–∞–∫, –±—É–¥—Ç–æ —É –Ω–µ—ë –µ—Å—Ç—å —Ç–∞–π–Ω–∞—è –∂–∏–∑–Ω—å?",
        "–ö—Ç–æ –∑–¥–µ—Å—å –ª—é–±–∏—Ç –∫–æ–Ω—Ç—Ä–æ–ª–∏—Ä–æ–≤–∞—Ç—å, –Ω–æ –¥–µ–ª–∞–µ—Ç –≤–∏–¥, —á—Ç–æ –Ω–µ—Ç?",
        "–ö—Ç–æ –±—É–¥–µ—Ç —Å–∞–º–æ–π —Å–ª–æ–∂–Ω–æ–π –ø–æ–¥—Ä—É–≥–æ–π?",
        "–ö—Ç–æ –∑–¥–µ—Å—å –º–æ–∂–µ—Ç –≤–Ω–µ–∑–∞–ø–Ω–æ –ø—Ä–æ–ø–∞—Å—Ç—å –Ω–∞ –Ω–µ–¥–µ–ª—é?",
        "–ö—Ç–æ –∫–∞–∂–µ—Ç—Å—è —Å–∞–º–æ–π –ø—Ä–∞–≤–∏–ª—å–Ω–æ–π ‚Äî –∏ —ç—Ç–æ –ø–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω–æ?",
        "–ö—Ç–æ –≤ —ç—Ç–æ–π –∫–æ–º–ø–∞–Ω–∏–∏ —Ç–æ—á–Ω–æ –ø–æ–º–Ω–∏—Ç –Ω–µ–ª–æ–≤–∫–∏–µ –º–æ–º–µ–Ω—Ç—ã –¥—Ä—É–≥–∏—Ö?",
        "–ö—Ç–æ —á–∞—â–µ –≤—Å–µ–≥–æ —É–ª—ã–±–∞–µ—Ç—Å—è –∏–∑ –≤–µ–∂–ª–∏–≤–æ—Å—Ç–∏?",
        "–ö—Ç–æ –∑–¥–µ—Å—å –≤—ã–≥–ª—è–¥–∏—Ç —Å–∞–º–æ–π —Ç–µ—Ä–ø–µ–ª–∏–≤–æ–π, –Ω–æ –≤–∑—Ä—ã–≤–∞–µ—Ç—Å—è —Ä–µ–∑–∫–æ?",
        "–ö—Ç–æ –∏–∑ –Ω–∞—Å –±—É–¥–µ—Ç –º–æ–ª—á–∞—Ç—å, –Ω–æ –≤—Å—ë –∑–∞–ø–æ–º–Ω–∏—Ç?",
        "–ö—Ç–æ –∑–¥–µ—Å—å –º–æ–∂–µ—Ç –æ–±—Å—É–∂–¥–∞—Ç—å –ª—é–¥–µ–π, –∞ –ø–æ—Ç–æ–º –±—ã—Ç—å —Å –Ω–∏–º–∏ –º–∏–ª–æ–π?",
        "–ö—Ç–æ —á–∞—â–µ –≤—Å–µ–≥–æ –≥–æ–≤–æ—Ä–∏—Ç ¬´–¥–∞ –Ω–µ –≤–∞–∂–Ω–æ¬ª, –∫–æ–≥–¥–∞ –≤–∞–∂–Ω–æ?",
        "–ö—Ç–æ –∏–∑ –Ω–∞—Å —Å–∞–º–∞—è –∑–∞–≥–∞–¥–æ—á–Ω–∞—è?",
        "–ö—Ç–æ –º–æ–∂–µ—Ç –≤–ª—é–±–ª—è—Ç—å—Å—è –±—ã—Å—Ç—Ä–µ–µ, —á–µ–º –ø—Ä–∏–∑–Ω–∞—ë—Ç—Å—è?",
        "–ö—Ç–æ –≤—ã–≥–ª—è–¥–∏—Ç —Å–∞–º–æ–π —Å–ø–æ–∫–æ–π–Ω–æ–π, –Ω–æ —É –Ω–µ—ë —Ö–∞–æ—Å –≤ –≥–æ–ª–æ–≤–µ?",
        "–ö—Ç–æ –∑–¥–µ—Å—å –ª—é–±–∏—Ç –≤–Ω–∏–º–∞–Ω–∏–µ, –Ω–æ –Ω–µ –ø—Ä–∏–∑–Ω–∞—ë—Ç—Å—è?",
        "–ö—Ç–æ –º–æ–∂–µ—Ç –ø–æ–¥–¥–µ—Ä–∂–∞—Ç—å, –Ω–æ –Ω–µ –±—É–¥–µ—Ç —Å—é—Å—é–∫–∞—Ç—å—Å—è?",
        "–ö—Ç–æ –∏–∑ –Ω–∞—Å —Ç–æ—á–Ω–æ –ª—é–±–∏—Ç —Å–ø–ª–µ—Ç–Ω–∏, –Ω–æ –æ—Ç—Ä–∏—Ü–∞–µ—Ç?",
        "–ö—Ç–æ –±—É–¥–µ—Ç –¥–æ–ª–≥–æ –ø–æ–º–Ω–∏—Ç—å —Å—Ç—Ä–∞–Ω–Ω–æ–µ –∑–Ω–∞–∫–æ–º—Å—Ç–≤–æ?",
        "–ö—Ç–æ –∑–¥–µ—Å—å –º–æ–∂–µ—Ç —Ä–µ–∑–∫–æ —Å–º–µ–Ω–∏—Ç—å –º–Ω–µ–Ω–∏–µ?",
        "–ö—Ç–æ —á–∞—â–µ –≤—Å–µ–≥–æ –¥—É–º–∞–µ—Ç ¬´–∞ —á—Ç–æ –æ–±–æ –º–Ω–µ –ø–æ–¥—É–º–∞—é—Ç¬ª?",
        "–ö—Ç–æ –≤—ã–≥–ª—è–¥–∏—Ç —Å–∞–º–æ–π —É–≤–µ—Ä–µ–Ω–Ω–æ–π, –Ω–æ —Å–æ–º–Ω–µ–≤–∞–µ—Ç—Å—è?",
        "–ö—Ç–æ –∏–∑ –Ω–∞—Å –º–æ–∂–µ—Ç –±—ã—Ç—å –ø–∞—Å—Å–∏–≤–Ω–æ-–∞–≥—Ä–µ—Å—Å–∏–≤–Ω–æ–π?",
        "–ö—Ç–æ –∑–¥–µ—Å—å —Ç–æ—á–Ω–æ —Ö–æ—Ä–æ—à–∞—è —Å–ª—É—à–∞—Ç–µ–ª—å–Ω–∏—Ü–∞?",
        "–ö—Ç–æ –º–æ–∂–µ—Ç –≤–µ–∂–ª–∏–≤–æ –æ—Ç–∫–∞–∑–∞—Ç—å—Å—è, –Ω–æ –ø–æ—Ç–æ–º –∂–∞–ª–µ—Ç—å?",
        "–ö—Ç–æ —á–∞—â–µ –≤—Å–µ–≥–æ —á—É–≤—Å—Ç–≤—É–µ—Ç –Ω–µ–ª–æ–≤–∫–æ—Å—Ç—å?",
        "–ö—Ç–æ –≤—ã–≥–ª—è–¥–∏—Ç —Å–∞–º–æ–π –æ—Ç–∫—Ä—ã—Ç–æ–π, –Ω–æ –¥–µ—Ä–∂–∏—Ç –¥–∏—Å—Ç–∞–Ω—Ü–∏—é?",
        "–ö—Ç–æ –∑–¥–µ—Å—å –º–æ–∂–µ—Ç —Ñ–ª–∏—Ä—Ç–æ–≤–∞—Ç—å, –Ω–µ –æ—Å–æ–∑–Ω–∞–≤–∞—è?",
        "–ö—Ç–æ –∏–∑ –Ω–∞—Å –ª–µ–≥–∫–æ —Å—á–∏—Ç—ã–≤–∞–µ—Ç –ª—é–¥–µ–π?",
        "–ö—Ç–æ —á–∞—â–µ –≤—Å–µ–≥–æ –∞–Ω–∞–ª–∏–∑–∏—Ä—É–µ—Ç —Å–µ–±—è?",
        "–ö—Ç–æ –∑–¥–µ—Å—å –º–æ–∂–µ—Ç –±—ã—Ç—å –Ω–µ–æ–∂–∏–¥–∞–Ω–Ω–æ —Ä–µ–∑–∫–æ–π?",
        "–ö—Ç–æ —Ç–æ—á–Ω–æ –Ω–µ –ª—é–±–∏—Ç –∫–æ–Ω—Ñ–ª–∏–∫—Ç—ã?",
        "–ö—Ç–æ –º–æ–∂–µ—Ç –±—ã—Ç—å —Å–ª–∏—à–∫–æ–º —Å–∞–º–æ–∫—Ä–∏—Ç–∏—á–Ω–æ–π?",
        "–ö—Ç–æ –∑–¥–µ—Å—å —á–∞—â–µ –≤—Å–µ–≥–æ –∏–∑–≤–∏–Ω—è–µ—Ç—Å—è?",
        "–ö—Ç–æ –∏–∑ –Ω–∞—Å –±–æ–∏—Ç—Å—è –ø–æ–∫–∞–∑–∞—Ç—å—Å—è —Å—Ç—Ä–∞–Ω–Ω–æ–π?",
        "–ö—Ç–æ –º–æ–∂–µ—Ç –ø–æ–∫–∞–∑–∞—Ç—å—Å—è —Ö–æ–ª–æ–¥–Ω–æ–π –ø—Ä–∏ –ø–µ—Ä–≤–æ–º –∑–Ω–∞–∫–æ–º—Å—Ç–≤–µ?",
        "–ö—Ç–æ –∑–¥–µ—Å—å —Å–∞–º–∞—è –Ω–∞–±–ª—é–¥–∞—Ç–µ–ª—å–Ω–∞—è?",
        "–ö—Ç–æ –º–æ–∂–µ—Ç –¥–æ–ª–≥–æ –ø—Ä–∏–≤—ã–∫–∞—Ç—å –∫ –ª—é–¥—è–º?",
        "–ö—Ç–æ –∏–∑ –Ω–∞—Å —Ç–æ—á–Ω–æ –≤—Å—ë —á—É–≤—Å—Ç–≤—É–µ—Ç –≥–ª—É–±–∂–µ, —á–µ–º –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç?",
        "–ö—Ç–æ –º–æ–∂–µ—Ç –±—ã—Ç—å ¬´—Ç–∏—Ö–∏–º –ª–∏–¥–µ—Ä–æ–º¬ª?",
        "–ö—Ç–æ —á–∞—â–µ –≤—Å–µ–≥–æ –¥—É–º–∞–µ—Ç –æ –±—É–¥—É—â–µ–º?",
        "–ö—Ç–æ –∑–¥–µ—Å—å –º–æ–∂–µ—Ç —É–¥–∏–≤–∏—Ç—å —Å–æ –≤—Ä–µ–º–µ–Ω–µ–º?",
        "–ö—Ç–æ –≤—ã–≥–ª—è–¥–∏—Ç —Å–∞–º–æ–π –ø—Ä–æ—Å—Ç–æ–π, –Ω–æ —ç—Ç–æ –Ω–µ —Ç–∞–∫?",
        "–ö—Ç–æ –∑–¥–µ—Å—å —Ç–æ—á–Ω–æ –∑–∞–ø–æ–º–Ω–∏—Ç—Å—è?",
        "–ö—Ç–æ –∏–∑ –Ω–∞—Å –º–æ–∂–µ—Ç –±—ã—Ç—å –Ω–µ–¥–æ–æ—Ü–µ–Ω—ë–Ω–Ω–æ–π?",
        "–ö—Ç–æ —á–∞—â–µ –≤—Å–µ–≥–æ —Å–æ–º–Ω–µ–≤–∞–µ—Ç—Å—è –ø–µ—Ä–µ–¥ –≤—ã–±–æ—Ä–æ–º?",
        "–ö—Ç–æ —Å–µ–≥–æ–¥–Ω—è –ø—Ä–∏—è—Ç–Ω–æ —É–¥–∏–≤–∏–ª?",
        "–ö–æ–≥–æ –±—ã —Ç—ã —Ö–æ—Ç–µ–ª–∞ —É–∑–Ω–∞—Ç—å –ø–æ–±–ª–∏–∂–µ?",
    ],
}

# ======================
# –°–û–°–¢–û–Ø–ù–ò–ï –ò–ì–†–´
# ======================

@dataclass
class Game:
    chat_id: int
    mode: str = ""
    players: List[str] = field(default_factory=list)
    current_player: int = 0
    question_index: int = 0

GAMES: Dict[int, Game] = {}

# ======================
# –ö–ù–û–ü–ö–ò
# ======================

def mode_keyboard():
    return InlineKeyboardMarkup([
        [InlineKeyboardButton("üç∑ –ú–û–Ø –ë–ï–°–¢–ò–Ø", callback_data="mode_bestia")],
        [InlineKeyboardButton("‚òï –ú–ï–ñ–î–£ –ù–ê–ú–ò, –î–ï–í–û–ß–ö–ê–ú–ò", callback_data="mode_coffee")],
    ])

def next_keyboard():
    return InlineKeyboardMarkup([
        [InlineKeyboardButton("üëâ –î–ê–õ–¨–®–ï", callback_data="next")]
    ])

# ======================
# –ö–û–ú–ê–ù–î–´
# ======================

async def start(update: Update, context: ContextTypes.DEFAULT_TYPE):
    await update.message.reply_text(
        "üíñ –î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å –≤ –∏–≥—Ä—É –¥–ª—è –¥–µ–≤–∏—á–Ω–∏–∫–æ–≤!\n\n"
        "–≠—Ç–∞ –∏–≥—Ä–∞ –ø–æ–¥—Ö–æ–¥–∏—Ç –∫–∞–∫ –¥–ª—è –æ–Ω–ª–∞–π–Ω (–≤ Telegram), —Ç–∞–∫ –∏ –¥–ª—è –æ—Ñ–ª–∞–π–Ω –≤—Å—Ç—Ä–µ—á.\n\n"
        "üí¨ –û–Ω–ª–∞–π–Ω: –∫–∞–∂–¥—ã–π –∏–≥—Ä–æ–∫ –ø–∏—à–µ—Ç –æ—Ç–≤–µ—Ç—ã –≤ —á–∞—Ç, –±–æ—Ç —Ç–æ–ª—å–∫–æ –≤—ã–¥–∞—ë—Ç –≤–æ–ø—Ä–æ—Å—ã –ø–æ –æ—á–µ—Ä–µ–¥–∏.\n"
        "üó£ –û—Ñ–ª–∞–π–Ω: –æ–¥–∏–Ω —Ç–µ–ª–µ—Ñ–æ–Ω/–ø–ª–∞–Ω—à–µ—Ç –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –≤–æ–ø—Ä–æ—Å—ã, –∏–≥—Ä–æ–∫–∏ –æ—Ç–≤–µ—á–∞—é—Ç –≤—Å–ª—É—Ö, –±–æ—Ç –≤–µ–¥—ë—Ç –æ—á–µ—Ä–µ–¥—å.\n\n"
        "–ö–æ–º–∞–Ω–¥—ã:\n"
        "/newgame ‚Äî –Ω–∞—á–∞—Ç—å –Ω–æ–≤—É—é –∏–≥—Ä—É\n\n"
        "–í—ã–±–µ—Ä–∏—Ç–µ —Ä–µ–∂–∏–º –∏ –Ω–∞—Å–ª–∞–∂–¥–∞–π—Ç–µ—Å—å —Å–º–µ—Ö–æ–º –∏ –æ–±—â–µ–Ω–∏–µ–º!"
    )

async def newgame(update: Update, context: ContextTypes.DEFAULT_TYPE):
    chat_id = update.effective_chat.id
    GAMES[chat_id] = Game(chat_id=chat_id)
    await update.message.reply_text(
        "–í—ã–±–µ—Ä–∏—Ç–µ —Ä–µ–∂–∏–º üëá",
        reply_markup=mode_keyboard()
    )

# ======================
# CALLBACK
# ======================

async def callback_handler(update: Update, context: ContextTypes.DEFAULT_TYPE):
    query = update.callback_query
    await query.answer()
    chat_id = query.message.chat_id
    game = GAMES.get(chat_id)
    if not game:
        return

    if query.data == "mode_bestia":
        game.mode = MODE_BESTIA
    elif query.data == "mode_coffee":
        game.mode = MODE_COFFEE

    await query.edit_message_text(
        "–¢–µ–ø–µ—Ä—å –Ω–∞–ø–∏—à–∏—Ç–µ –∏–º–µ–Ω–∞ –≤—Å–µ—Ö —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤ —á–µ—Ä–µ–∑ –∑–∞–ø—è—Ç—É—é (–º–∏–Ω 2, –º–∞–∫—Å 10)\n–ü—Ä–∏–º–µ—Ä: –ê–Ω—è, –ú–∞—à–∞, –ö–∞—Ç—è"
    )

# ======================
# –í–í–û–î –ò–ì–†–û–ö–û–í
# ======================

async def handle_players(update: Update, context: ContextTypes.DEFAULT_TYPE):
    chat_id = update.effective_chat.id
    game = GAMES.get(chat_id)
    if not game or not game.mode:
        return

    text = update.message.text
    players = [p.strip() for p in text.split(",") if p.strip()]
    if len(players) < 2:
        await update.message.reply_text("–ú–∏–Ω–∏–º—É–º 2 –∏–≥—Ä–æ–∫–∞, –ø–æ–ø—Ä–æ–±—É–π—Ç–µ –µ—â—ë —Ä–∞–∑")
        return
    if len(players) > 10:
        await update.message.reply_text("–ú–∞–∫—Å–∏–º—É–º 10 –∏–≥—Ä–æ–∫–æ–≤, –ø–æ–ø—Ä–æ–±—É–π—Ç–µ –µ—â—ë —Ä–∞–∑")
        return

    game.players = players
    game.current_player = 0
    game.question_index = 0
    await send_question(update, context, game)

# ======================
# –û–¢–ü–†–ê–í–ö–ê –í–û–ü–†–û–°–ê
# ======================

async def send_question(update, context, game: Game):
    if game.question_index >= len(QUESTIONS[game.mode]):
        await context.bot.send_message(game.chat_id, "üéâ –ò–≥—Ä–∞ –æ–∫–æ–Ω—á–µ–Ω–∞! –ë—ã–ª–æ –≤–µ—Å–µ–ª–æ üíñ")
        GAMES.pop(game.chat_id, None)
        return

    player = game.players[game.current_player]
    question = QUESTIONS[game.mode][game.question_index]

    await context.bot.send_message(
        game.chat_id,
        f"üéØ –•–æ–¥: {player}\n\nüí¨ {question}",
        reply_markup=next_keyboard()
    )

    # –ø–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –∫ —Å–ª–µ–¥—É—é—â–µ–º—É —Ö–æ–¥—É
    game.current_player = (game.current_player + 1) % len(game.players)
    game.question_index += 1

# ======================
# NEXT CALLBACK
# ======================

async def next_question(update: Update, context: ContextTypes.DEFAULT_TYPE):
    query = update.callback_query
    await query.answer()
    chat_id = query.message.chat_id
    game = GAMES.get(chat_id)
    if not game:
        return
    await send_question(update, context, game)

# ======================
# –ó–ê–ü–£–°–ö
# ======================

def main():
    token = os.getenv("BOT_TOKEN")
    if not token:
        print("‚ö†Ô∏è BOT_TOKEN not set")
        return

    app = Application.builder().token(token).build()
    app.add_handler(CommandHandler("start", start))
    app.add_handler(CommandHandler("newgame", newgame))
    app.add_handler(MessageHandler(filters.TEXT & ~filters.COMMAND, handle_players))
    app.add_handler(CallbackQueryHandler(callback_handler, pattern="^mode_"))
    app.add_handler(CallbackQueryHandler(next_question, pattern="^next$"))
    app.run_polling()

if __name__ == "__main__":
    main()

