from aiogram import Bot, Dispatcher, types
from aiogram.types import ReplyKeyboardMarkup, KeyboardButton
from aiogram.utils import executor
import logging
import random

API_TOKEN = "–í–°–¢–ê–í–¨_–°–Æ–î–ê_–¢–û–ö–ï–ù"

logging.basicConfig(level=logging.INFO)

bot = Bot(token=API_TOKEN)
dp = Dispatcher(bot)

# =======================
# –°–û–°–¢–û–Ø–ù–ò–ï –ò–ì–†–´
# =======================

games = {}  # chat_id -> dict


# =======================
# –í–û–ü–†–û–°–´ ‚Äî –ö–¢–û –ò–ó –ù–ê–°
# (–ù–ï –ú–ï–ù–Ø–õ–ê, –ö–ê–ö –¢–´ –î–ê–õ–ê)
# =======================

QUESTIONS_WHO = [
    {"q": "–¢—ã –ø–∏—à–µ—à—å ¬´–æ–∫¬ª ‚Äî —ç—Ç–æ‚Ä¶"},
    {"q": "–ï—Å–ª–∏ —è –æ–ø–∞–∑–¥—ã–≤–∞—é –Ω–∞ 20 –º–∏–Ω—É—Ç, —Ç—ã‚Ä¶"},
    {"q": "–í –ø–ª–æ—Ö–æ–º –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∏–∏ –º–Ω–µ –ª—É—á—à–µ –ø—Ä–∏—Å–ª–∞—Ç—å‚Ä¶"},
    {"q": "–ú—ã –º–æ–∂–µ–º –Ω–µ –æ–±—â–∞—Ç—å—Å—è –º–µ—Å—è—Ü –∏ –Ω–µ –æ–±–∏–∂–∞—Ç—å—Å—è?"},
    {"q": "–ï—Å–ª–∏ –º—ã –ø–æ—Å—Å–æ—Ä–∏–ª–∏—Å—å ‚Äî –∫—Ç–æ –ø–µ—Ä–≤—ã–π –ø—Ä–∏—à–ª—ë—Ç –º–µ–º?"},
    {"q": "–ö–∞–∫—É—é —Å–∞–º—É—é —Å—Ç—Ä–∞–Ω–Ω—É—é –ø—Ä–∏–≤—ã—á–∫—É —É –º–µ–Ω—è –∑–Ω–∞–µ—à—å?"},
    {"q": "–ï—Å–ª–∏ –º—ã –∏–¥—ë–º –Ω–∞ –≤–µ—á–µ—Ä–∏–Ω–∫—É –≤–º–µ—Å—Ç–µ, –∫—Ç–æ –ø–æ—Ç–µ—Ä—è–µ—Ç—Å—è –ø–µ—Ä–≤—ã–º?"},
    {"q": "–ö—Ç–æ –∏–∑ –Ω–∞—Å –±–æ–ª—å—à–µ –ª—é–±–∏—Ç –∫–æ—Ñ–µ?"},
    {"q": "–ï—Å–ª–∏ –≤–¥—Ä—É–≥ –Ω–∞—á–Ω—ë—Ç—Å—è —Ç–∞–Ω—Ü–µ–≤–∞–ª—å–Ω—ã–π –±–∞—Ç—Ç–ª, –∫—Ç–æ –≤—ã–∏–≥—Ä–∞–µ—Ç?"},
    {"q": "–ö—Ç–æ —á–∞—â–µ –∑–∞–±—ã–≤–∞–µ—Ç –∫–ª—é—á–∏?"},
    {"q": "–° –∫–µ–º –ª–µ–≥—á–µ –ø–æ–¥–µ–ª–∏—Ç—å—Å—è —Å–µ–∫—Ä–µ—Ç–æ–º?"},
    {"q": "–ö—Ç–æ –≥—Ä–æ–º—á–µ —Å–º–µ—ë—Ç—Å—è?"},
    {"q": "–ï—Å–ª–∏ –±—ã –º—ã —Å—Ç–∞–ª–∏ —Å—É–ø–µ—Ä–≥–µ—Ä–æ—è–º–∏, –∫—Ç–æ –±—ã –±—ã–ª‚Ä¶"},
    {"q": "–ö—Ç–æ —á–∞—â–µ –Ω–∞—á–∏–Ω–∞–µ—Ç —Å–ø–æ—Ä—ã?"},
    {"q": "–ö—Ç–æ –±—ã—Å—Ç—Ä–µ–µ –µ—Å—Ç —Å–ª–∞–¥–∫–æ–µ?"},
    {"q": "–ö—Ç–æ –ª—É—á—à–µ –≥–æ—Ç–æ–≤–∏—Ç –º–µ–º—ã?"},
    {"q": "–ï—Å–ª–∏ —è –ø–ª–∞—á—É –Ω–∞–¥ —Å–µ—Ä–∏–∞–ª–æ–º, –∫—Ç–æ –º–µ–Ω—è –ø–æ–π–º—ë—Ç?"},
    {"q": "–ö—Ç–æ —á–∞—â–µ —Å—Ç–∞–≤–∏—Ç –ª–∞–π–∫–∏ –Ω–∞ —Å—Ç–æ—Ä–∏—Å?"},
    {"q": "–ï—Å–ª–∏ —á—Ç–æ-—Ç–æ –ø–æ—à–ª–æ –Ω–µ —Ç–∞–∫, –∫—Ç–æ –±—ã—Å—Ç—Ä–µ–µ —Å–¥–∞—ë—Ç—Å—è?"},
    {"q": "–ö—Ç–æ –∏–∑ –Ω–∞—Å –±–æ–ª—å—à–µ –ª—é–±–∏—Ç –ø—Ä–∏–∫–ª—é—á–µ–Ω–∏—è?"},
    {"q": "–ö—Ç–æ –ª—É—á—à–µ —Ö—Ä–∞–Ω–∏—Ç —Å–µ–∫—Ä–µ—Ç—ã?"},
    {"q": "–ï—Å–ª–∏ –∫—Ç–æ-—Ç–æ —Å–∫—É—á–∞–µ—Ç, –∫—Ç–æ –ø–µ—Ä–≤—ã–º –Ω–∞–ø–∏—à–µ—Ç?"},
    {"q": "–ö—Ç–æ —á–∞—â–µ –¥–µ–ª–∞–µ—Ç —Å–º–µ—à–Ω—ã–µ —Å–µ–ª—Ñ–∏?"},
    {"q": "–ö—Ç–æ —á–∞—â–µ —Å–ø–æ—Ä–∏—Ç –æ —Ñ–∏–ª—å–º–∞—Ö?"},
    {"q": "–ö—Ç–æ –±—ã—Å—Ç—Ä–µ–µ –æ—Ç–≤–µ—á–∞–µ—Ç –Ω–∞ —Å–æ–æ–±—â–µ–Ω–∏—è?"},
    {"q": "–ö—Ç–æ —á–∞—â–µ –±–µ—Ä—ë—Ç –∏–Ω–∏—Ü–∏–∞—Ç–∏–≤—É?"},
    {"q": "–ï—Å–ª–∏ —è –≥—Ä—É—â—É, –∫—Ç–æ –º–µ–Ω—è —Ä–∞–∑–≤–µ—Å–µ–ª–∏—Ç?"},
    {"q": "–ö—Ç–æ –±—ã—Å—Ç—Ä–µ–µ –Ω–∞—á–∏–Ω–∞–µ—Ç —à—É—Ç–∏—Ç—å?"},
    {"q": "–ï—Å–ª–∏ –∏–¥—ë–º –≤ –º–∞–≥–∞–∑–∏–Ω, –∫—Ç–æ –±–æ–ª—å—à–µ –ø–æ–∫—É–ø–∞–µ—Ç?"},
    {"q": "–ö—Ç–æ —á–∞—â–µ –æ—Ä–≥–∞–Ω–∏–∑—É–µ—Ç –≤—Å—Ç—Ä–µ—á–∏?"},
    {"q": "–ö—Ç–æ —á–∞—â–µ –æ–ø–∞–∑–¥—ã–≤–∞–µ—Ç –Ω–∞ –≤—Å—Ç—Ä–µ—á–∏?"},
    {"q": "–ö—Ç–æ —Å–º–µ—à–Ω–µ–µ —à—É—Ç–∏—Ç?"},
    {"q": "–ö—Ç–æ –ª—É—á—à–µ –∑–∞–ø–æ–º–∏–Ω–∞–µ—Ç –∏–º–µ–Ω–∞?"},
    {"q": "–ö—Ç–æ —á–∞—â–µ –ø—Ä–µ–¥–ª–∞–≥–∞–µ—Ç –∏–¥–µ–∏?"},
    {"q": "–ö—Ç–æ —Å–∏–ª—å–Ω–µ–µ –≤–ª–∏—è–µ—Ç –Ω–∞ –¥—Ä—É–≥–∏—Ö?"},
    {"q": "–ö—Ç–æ –±—ã—Å—Ç—Ä–µ–µ –Ω–∞—Ö–æ–¥–∏—Ç –º–µ–º—ã?"},
    {"q": "–ö—Ç–æ —á–∞—â–µ –¥–µ–ª–∞–µ—Ç –∫–æ–º–ø–ª–∏–º–µ–Ω—Ç—ã?"},
    {"q": "–ö—Ç–æ –±—ã—Å—Ç—Ä–µ–µ –æ—Å–≤–∞–∏–≤–∞–µ—Ç –Ω–æ–≤—ã–µ –ø—Ä–∏–≤—ã—á–∫–∏?"},
    {"q": "–ö—Ç–æ —á–∞—â–µ —à—É—Ç–∏—Ç –ø—Ä–æ –µ–¥—É?"},
    {"q": "–ö—Ç–æ –≥—Ä–æ–º—á–µ —Å–º–µ—ë—Ç—Å—è –Ω–∞–¥ –º–µ–º–∞–º–∏?"},
    {"q": "–ö—Ç–æ —á–∞—â–µ —Ç–µ—Ä—è–µ—Ç –≤–µ—â–∏?"},
    {"q": "–ö—Ç–æ –∏–∑ –Ω–∞—Å –±–æ–ª—å—à–µ —Å–ø–æ–Ω—Ç–∞–Ω–Ω—ã–π?"},
    {"q": "–ö—Ç–æ —á–∞—â–µ –ø–∏—à–µ—Ç –ø–µ—Å–Ω–∏, —Å—Ç–∏—Ö–∏ –∏–ª–∏ —à—É—Ç–∫–∏?"},
    {"q": "–ö—Ç–æ –±—ã—Å—Ç—Ä–µ–µ —Ä–µ–∞–≥–∏—Ä—É–µ—Ç –Ω–∞ –Ω–æ–≤–æ—Å—Ç–∏?"},
    {"q": "–ö—Ç–æ —á–∞—â–µ –¥–µ–ª–∞–µ—Ç –Ω–µ–æ–±—ã—á–Ω—ã–µ –ø–æ–∫—É–ø–∫–∏?"},
    {"q": "–ö—Ç–æ –ª—É—á—à–µ –≥–æ—Ç–æ–≤ –¥–µ–ª–∏—Ç—å—Å—è?"},
    {"q": "–ö—Ç–æ —á–∞—â–µ –∑–∞–±—ã–≤–∞–µ—Ç –¥–Ω–∏ —Ä–æ–∂–¥–µ–Ω–∏—è?"},
    {"q": "–ö—Ç–æ —á–∞—â–µ –±–µ—Ä—ë—Ç –∏–Ω–∏—Ü–∏–∞—Ç–∏–≤—É –≤ —Ä–∞–∑–≥–æ–≤–æ—Ä–∞—Ö?"},
    {"q": "–ö—Ç–æ –≥—Ä–æ–º—á–µ —Ä–µ–∞–≥–∏—Ä—É–µ—Ç –Ω–∞ –º–µ–º—ã?"},
    {"q": "–ö—Ç–æ —á–∞—â–µ —à—É—Ç–∏—Ç –ø—Ä–æ —Ä–∞–±–æ—Ç—É?"},
    {"q": "–ö—Ç–æ –±–æ–ª—å—à–µ –ª—é–±–∏—Ç —Å–ø–æ–Ω—Ç–∞–Ω–Ω—ã–µ –≤–µ—á–µ—Ä–∏–Ω–∫–∏?"},
    {"q": "–ö—Ç–æ —á–∞—â–µ –¥–µ–ª–∞–µ—Ç –∫–æ–º–ø–ª–∏–º–µ–Ω—Ç—ã –Ω–µ–∑–Ω–∞–∫–æ–º—Ü–∞–º?"},
    {"q": "–ö—Ç–æ –ª—É—á—à–µ –∑–Ω–∞–µ—Ç –∏—Å—Ç–æ—Ä–∏–∏ –¥—Ä—É–≥ –¥—Ä—É–≥–∞?"},
    {"q": "–ö—Ç–æ —á–∞—â–µ —Å–º–µ—ë—Ç—Å—è –Ω–∞–¥ —Å–æ–±–æ–π?"}
]


# =======================
# –ö–û–ú–ú–ï–ù–¢–ê–†–ò–ò
# =======================

COMMENTS_COFFEE = [
    "‚òï –ü–æ–¥ –∫–æ—Ñ–µ —ç—Ç–æ –∑–≤—É—á–∏—Ç –æ—Å–æ–±–µ–Ω–Ω–æ —á–µ—Å—Ç–Ω–æ",
    "‚òï –¢—É—Ç —è–≤–Ω–æ –±—ã–ª–æ –±–µ–∑ —Ñ–∏–ª—å—Ç—Ä–æ–≤",
    "‚òï –ö–∞–∂–µ—Ç—Å—è, —É –∫–æ–≥–æ-—Ç–æ –∏–Ω—Å–∞–π—Ç"
]

COMMENTS_WINE = [
    "üç∑ –ü–æ–¥ –±–æ–∫–∞–ª –≤–∏–Ω–∞ —Ç–∞–∫–∏–µ –æ—Ç–≤–µ—Ç—ã —Å–º–µ–ª–µ–µ",
    "üç∑ –≠—Ç–æ —Ç–æ—á–Ω–æ —Å–∫–∞–∑–∞–Ω–æ –Ω–µ –Ω–∞ —Ç—Ä–µ–∑–≤—É—é –≥–æ–ª–æ–≤—É",
    "üç∑ –û–π, —Ç—É—Ç –ø–æ—à–ª–∞ –ø—Ä–∞–≤–¥–∞"
]


# =======================
# –ö–ù–û–ü–ö–ò
# =======================

kb_ready = ReplyKeyboardMarkup(resize_keyboard=True)
kb_ready.add(KeyboardButton("–ì–û–¢–û–í–û"))

kb_next = ReplyKeyboardMarkup(resize_keyboard=True)
kb_next.add(KeyboardButton("–î–ê–õ–¨–®–ï"))


# =======================
# –°–¢–ê–†–¢ + –ò–ù–°–¢–†–£–ö–¶–ò–Ø
# =======================

@dp.message_handler(commands=["start"])
async def start(message: types.Message):
    games[message.chat.id] = {
        "index": 0,
        "answers": [],
        "mode": random.choice(["coffee", "wine"])
    }

    await message.answer(
        "‚òïüç∑ –§–û–†–ú–ê–¢ –ò–ì–†–´\n\n"
        "–ú–æ–∂–Ω–æ –∏–≥—Ä–∞—Ç—å:\n"
        "‚Äî –ø–æ–¥ —á–∞—à–∫—É –∫–æ—Ñ–µ\n"
        "‚Äî –ø–æ–¥ –±–æ–∫–∞–ª –≤–∏–Ω–∞\n\n"
        "–ú–æ–∂–Ω–æ:\n"
        "‚Äî –ø–∏—Å–∞—Ç—å –∫–æ—Ä–æ—Ç–∫–æ\n"
        "‚Äî –æ—Ç–≤–µ—á–∞—Ç—å –≤—Å–ª—É—Ö\n"
        "‚Äî –æ–±—Å—É–∂–¥–∞—Ç—å –æ—Ç–≤–µ—Ç—ã –º–µ–∂–¥—É —Å–æ–±–æ–π\n\n"
        "–≠—Ç–æ –Ω–µ —Ç–µ—Å—Ç –∏ –Ω–µ –∞–Ω–∫–µ—Ç–∞,\n"
        "–∞ –ø–æ–≤–æ–¥ –ø–æ—Å–º–µ—è—Ç—å—Å—è, –ø–æ–≥–æ–≤–æ—Ä–∏—Ç—å –∏ –ø–æ—á—É–≤—Å—Ç–≤–æ–≤–∞—Ç—å –∞—Ç–º–æ—Å—Ñ–µ—Ä—É.\n\n"
        "–ù–∞–∂–º–∏ –ì–û–¢–û–í–û, —á—Ç–æ–±—ã –Ω–∞—á–∞—Ç—å",
        reply_markup=kb_ready
    )


# =======================
# –ù–ê–ß–ê–õ–û –ò–ì–†–´
# =======================

@dp.message_handler(lambda m: m.text == "–ì–û–¢–û–í–û")
async def begin(message: types.Message):
    await send_question(message.chat.id)


async def send_question(chat_id):
    game = games.get(chat_id)

    if game["index"] >= len(QUESTIONS_WHO):
        await bot.send_message(
            chat_id,
            "üíõ –°–ø–∞—Å–∏–±–æ –∑–∞ —ç—Ç–æ—Ç –≤–µ—á–µ—Ä.\n"
            "–ü—É—Å—Ç—å –æ–Ω –æ—Å—Ç–∞–Ω–µ—Ç—Å—è —Ç—ë–ø–ª—ã–º –≤–æ—Å–ø–æ–º–∏–Ω–∞–Ω–∏–µ–º.\n"
            "–ë–µ—Ä–µ–≥–∏—Ç–µ —ç—Ç–æ —Å–æ—Å—Ç–æ—è–Ω–∏–µ."
        )
        games.pop(chat_id)
        return

    game["answers"] = []

    await bot.send_message(
        chat_id,
        f"‚ùì {QUESTIONS_WHO[game['index']]['q']}\n\n"
        "–û—Ç–≤–µ—Ç—å—Ç–µ –≤ —á–∞—Ç–µ.\n"
        "–ö–æ–≥–¥–∞ –≤—Å–µ –≥–æ—Ç–æ–≤—ã ‚Äî –Ω–∞–∂–º–∏—Ç–µ ¬´–î–ê–õ–¨–®–ï¬ª",
        reply_markup=kb_next
    )


# =======================
# –°–ë–û–† –û–¢–í–ï–¢–û–í + –ü–ê–£–ó–ê
# =======================

@dp.message_handler()
async def collect(message: types.Message):
    chat_id = message.chat.id
    if chat_id not in games:
        return

    game = games[chat_id]

    if message.text == "–î–ê–õ–¨–®–ï":
        if not game["answers"]:
            await message.answer("–ù—É —Ö–æ—Ç—å —Ç–æ—á–∫—É –∫—Ç–æ-–Ω–∏–±—É–¥—å –ø–æ—Å—Ç–∞–≤—å—Ç–µ üòÑ")
            return

        chosen = random.choice(game["answers"])
        comment = random.choice(
            COMMENTS_COFFEE if game["mode"] == "coffee" else COMMENTS_WINE
        )

        await message.answer(f"üí¨ {chosen}\n\n{comment}")

        game["index"] += 1
        await send_question(chat_id)
        return

    game["answers"].append(message.text)


# =======================
# –ó–ê–ü–£–°–ö
# =======================

if __name__ == "__main__":
    executor.start_polling(dp, skip_updates=True)
